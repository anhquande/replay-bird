!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){"use strict";function n(e){var t,i,n;return{x:e.x||0,y:e.y||0,rotation:e.rotation||0,opacity:Math.min(1,Math.max(0,null!==(t=e.opacity)&&void 0!==t?t:1)),scaleX:null!==(i=e.scaleX)&&void 0!==i?i:1,scaleY:null!==(n=e.scaleY)&&void 0!==n?n:1,anchorX:e.anchorX||0,anchorY:e.anchorY||0,mask:e.mask||null}}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.r(t),i.d(t,"t",(function(){return r})),i.d(t,"makeSprite",(function(){return o})),i.d(t,"makeNativeSprite",(function(){return a})),i.d(t,"mask",(function(){return s}));var n=i(0);const r={text:e=>({type:"text",props:{testId:e.testId,...Object(n.a)(e),font:e.font,text:e.text,align:e.align||"center",color:e.color}}),circle:e=>({type:"circle",props:{testId:e.testId,...Object(n.a)(e),radius:e.radius,color:e.color}}),rectangle:e=>({type:"rectangle",props:{testId:e.testId,...Object(n.a)(e),width:e.width,height:e.height,color:e.color}}),line:e=>{var t;return{type:"line",props:{testId:e.testId,...Object(n.a)(e),color:e.color,fillColor:e.fillColor,thickness:null!==(t=e.thickness)&&void 0!==t?t:1,lineCap:e.lineCap||"butt",path:e.path}}},image:e=>({type:"image",props:{testId:e.testId,...Object(n.a)(e),fileName:e.fileName,width:e.width,height:e.height}}),spriteSheet:e=>({type:"spriteSheet",props:{testId:e.testId,...Object(n.a)(e),fileName:e.fileName,columns:e.columns,rows:e.rows,index:e.index,width:e.width,height:e.height}})};function o(e){return t=>({type:"custom",spriteObj:e,props:t})}function a(e){return t=>({type:"native",name:e,props:t})}const s={circle:e=>({type:"circleMask",radius:e.radius,x:e.x||0,y:e.y||0}),rectangle:e=>({type:"rectangleMask",width:e.width,height:e.height,x:e.x||0,y:e.y||0}),line:e=>({type:"lineMask",path:e.path})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(8),r=i(3);n.renderCanvas(r.Game(r.gameProps),r.options)},function(e,t,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),o=i(4),a=i(7);t.options={loadingTextures:[r.t.text({color:"black",text:"Loading..."})],assets:{imageFileNames:["bird.png"],audioFileNames:["boop.wav"]}},t.Game=r.makeSprite({init:function(e){var t=e.device.storage.getStore();return{view:"menu",attempt:0,highScore:Number(t.highScore||"0")}},render:function(e){var t=e.state,i=e.updateState,r=e.device,s="menu"===t.view;return[o.Level({id:"level-"+t.attempt,paused:s,gameOver:function(e){i((function(t){var i=t.highScore;return e>i&&(i=e,r.storage.setStore({highScore:String(i)})),n(n({},t),{view:"menu",highScore:i})}))}}),s?a.Menu({id:"menu",highScore:t.highScore,start:function(){i((function(e){return n(n({},e),{view:"level",attempt:e.attempt+1})}))}}):null]}}),t.gameProps={id:"Game",size:{width:400,height:600,maxHeightMargin:150},defaultFont:{name:"Helvetica",size:24}}},function(e,t,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)n[r]=o[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),a=i(5),s=i(6);function c(e){var t=(e.size.height+2*e.size.heightMargin-2*s.pipeGap)*(e.random()-.5);return{x:e.size.width+e.size.widthMargin+50,gapY:t,passed:!1}}function d(e,t){return e.x>t.x-t.width/2&&e.x<t.x+t.width/2&&e.y>t.y-t.height/2&&e.y<t.y+t.height/2}t.Level=o.makeSprite({init:function(e){var t=e.device;return{birdY:10,birdGravity:-12,pipes:e.props.paused?[]:[c(t)],score:0}},loop:function(e){var t=e.props,i=e.state,o=e.device;if(t.paused)return i;var h=o.inputs,u=i.birdGravity,l=i.birdY,p=i.pipes,g=i.score;return l-=u+=.8,(h.pointer.justPressed||h.keysJustPressed[" "])&&(u=-12),p[p.length-1].x<140&&(p=r(p,[c(o)]).filter((function(e){return e.x>-(o.size.width+o.size.widthMargin+s.pipeWidth)}))),function(e,t,i){if(e-a.birdHeight/2<-(t.height/2+t.heightMargin)||e+a.birdHeight/2>t.height/2+t.heightMargin)return!0;for(var n=function(i){if(i.x>0+a.birdWidth/2+s.pipeWidth/2||i.x<0-a.birdWidth/2-s.pipeWidth/2)return"continue";var n=s.getPipeYPositions(t,i.gapY),r=n.yUpperTop,o=n.yUpperBottom,c=n.yLowerTop,h=n.yLowerBottom,u={x:i.x,y:(r+o)/2,width:s.pipeWidth,height:r-o},l={x:i.x,y:(c+h)/2,width:s.pipeWidth,height:c-h};return[{x:0+a.birdWidth/2,y:e+a.birdHeight/2},{x:0+a.birdWidth/2,y:e-a.birdHeight/2},{x:0,y:e+a.birdHeight/2},{x:0,y:e-a.birdHeight/2},{x:0-a.birdWidth/2,y:e+a.birdHeight/2},{x:0-a.birdWidth/2,y:e-a.birdHeight/2}].some((function(e){return d(e,u)||d(e,l)}))?{value:!0}:void 0},r=0,o=i;r<o.length;r++){var c=o[r],h=n(c);if("object"==typeof h)return h.value}return!1}(l,o.size,p)&&(o.audio("boop.wav").play(),t.gameOver(i.score)),{birdGravity:u,birdY:l,pipes:p=p.map((function(e){var t=e.passed;return!t&&e.x<0-a.birdWidth/2-s.pipeWidth/2&&(t=!0,g++),n(n({},e),{passed:t,x:e.x-2})})),score:g}},render:function(e){var t=e.state,i=e.device,n=i.size;return r([o.t.rectangle({color:"#add8e6",width:n.width+2*n.widthMargin,height:n.height+2*n.heightMargin}),a.Bird({id:"bird",x:0,y:t.birdY,rotation:Math.max(-30,3*t.birdGravity-30)})],t.pipes.map((function(e,t){return s.Pipe({id:"pipe-"+t,pipe:e,x:e.x})})),[o.t.text({text:"Score: "+t.score,color:"white",x:-i.size.width/2+10,y:i.size.height/2+i.size.heightMargin-80,align:"left"})])}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);t.birdWidth=50,t.birdHeight=40,t.Bird=n.makeSprite({render:function(){return[n.t.image({testId:"bird",fileName:"bird.png",width:t.birdWidth,height:t.birdHeight})]}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);function r(e,i){return{yUpperTop:e.height/2+e.heightMargin,yUpperBottom:i+t.pipeGap/2,yLowerTop:i-t.pipeGap/2,yLowerBottom:-e.height/2-e.heightMargin}}t.pipeWidth=40,t.pipeGap=170,t.Pipe=n.makeSprite({render:function(e){var i=e.props,o=r(e.device.size,i.pipe.gapY),a=o.yUpperTop,s=o.yUpperBottom,c=o.yLowerTop,d=o.yLowerBottom;return[n.t.rectangle({color:"green",width:t.pipeWidth,height:a-s,y:(a+s)/2}),n.t.rectangle({color:"green",width:t.pipeWidth,height:c-d,y:(c+d)/2})]}}),t.getPipeYPositions=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);t.Menu=n.makeSprite({render:function(e){var t=e.props,i=e.device,r=i.inputs;return(r.pointer.justReleased||r.keysJustPressed[" "])&&t.start(),[n.t.text({text:i.isTouchScreen?"Tap to Start":"Click or Space Bar to Start",color:"white",y:100}),n.t.text({text:"High score: "+t.highScore,font:{name:"Courier",size:24},color:"white",y:150})]}})},function(e,t,i){"use strict";i.r(t),i.d(t,"mapInputCoordinates",(function(){return u})),i.d(t,"renderCanvas",(function(){return O}));var n=i(0);function r(e,t,i,o,s,d,h,u,l,p){const g=Object(n.a)(t);g.opacity*=u;const{nativeSpriteMap:f,nativeSpriteUtils:m}=p,v=e=>{const t=o(e);return function(e){const t=Math.PI/180,i=-(e.rotation||0)*t;return({x:t,y:n})=>{const r=t-e.x,o=n-e.y,a=r*Math.cos(i)+o*Math.sin(i),s=-r*Math.sin(i)+o*Math.cos(i),c=a/e.scaleX,d=s/e.scaleY;return{x:c+e.anchorX,y:d+e.anchorY}}}(g)(t)},w=i(v),y=e.getSprites(t,w,s,d,h),b=[],x=y.map(t=>{if(!t)return t;if("native"===t.type){b.push(t.props.id);const i=f[t.name];if(!i)throw Error(`Cannot find Native Sprite "${t.name}"`);let n=e.childContainers[t.props.id];return n&&"native"===n.type||(n={type:"native",state:i.create({props:t.props,parentGlobalId:l,getState:()=>n.state,updateState:e=>{n.state={...n.state,...e}},utils:m}),cleanup:i.cleanup},e.childContainers[t.props.id]=n),n.state=i.loop({props:t.props,state:n.state,parentGlobalId:l,utils:m}),m.didResize=!1,null}if("custom"===t.type){b.push(t.props.id);let n=!1,o=e.childContainers[t.props.id];return o&&"custom"===o.type||(n=!0,o=a(t,w,e.prevTime),e.childContainers[t.props.id]=o),r(o,t.props,i,v,n,d,h,g.opacity,`${l}--${t.props.id}`,p)}return t}).filter(c),P=e=>{Object.keys(e).forEach(t=>{if(!b.includes(t)){const i=e[t];"native"===i.type?i.cleanup({state:i.state,parentGlobalId:l}):P(i.childContainers),delete e[t]}})};return P(e.childContainers),{id:t.id,baseProps:g,textures:x}}const o=1/60*1e3;function a(e,t,i){const{spriteObj:n,props:r}=e,o=[],a=e=>{o.push(e)};let s;return n.init&&(s=n.init({props:r,device:t,updateState:a})),{type:"custom",state:s,childContainers:{},prevTime:i,currentLag:0,getSprites(e,t,i,r,s){const c=()=>{this.state=o.reduce((e,t)=>t(e),this.state),o.length=0};c(),!i&&n.loop&&(this.state=n.loop({props:e,state:this.state,device:t,updateState:a})),c();let d=n[r];d||(d="renderPXL"===r&&n.renderXL?n.renderXL:n.render);const h=d({props:e,state:this.state,device:t,updateState:a,extrapolateFactor:s});return c(),h}}}function s(e,t){const i=e.deviceHeight>e.deviceWidth;let n,r=!1;return"portrait"in t?(n=i?t.portrait:t.landscape,r=!0):n=t,n.minHeightXL&&e.deviceHeight>=n.minHeightXL||n.minWidthXL&&e.deviceWidth>=n.minWidthXL?r&&i?"renderPXL":"renderXL":r&&i?"renderP":"render"}function c(e){return null!==e}let d={keysDown:{},keysJustPressed:{},pointer:{pressed:!1,numberPressed:0,justPressed:!1,justReleased:!1,x:0,y:0}},h=[];function u(e,t){const i=e(t.pointer);return{...t,pointer:{...t.pointer,x:i.x,y:i.y}}}function l(e){return u(e,d)}function p(e){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&!(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement)&&e.preventDefault(),d.keysDown[e.key]=!0,d.keysJustPressed[e.key]=!0}function g(e){delete d.keysDown[e.key]}function f(e,t,i){h.includes(i)||(h=[...h,i]),d.pointer.pressed=!0,d.pointer.numberPressed=h.length,d.pointer.justPressed=!0,d.pointer.x=e,d.pointer.y=t}function m(e,t){d.pointer.x=e,d.pointer.y=t}function v(e,t,i){h=h.filter(e=>e!==i),0===h.length&&(d.pointer.justPressed=!1,d.pointer.pressed=!1),d.pointer.numberPressed=h.length,d.pointer.justReleased=!0,d.pointer.x=e,d.pointer.y=t}function w(e){h=h.filter(t=>t!==e),d.pointer.numberPressed=h.length,0===h.length&&(d.pointer.justPressed=!1,d.pointer.pressed=!1)}function y(){d={keysDown:d.keysDown,keysJustPressed:{},pointer:{...d.pointer,justPressed:!1,justReleased:!1}}}function b(e,{width:t,height:i,widthMargin:n,heightMargin:r,deviceWidth:o,deviceHeight:a},s,c){e.save();const d=Math.min(o/t,a/i),h=t+2*n,u=i+2*r;return e.translate(o/2,a/2),e.scale(d,d),{scale:d,render:t=>{e.clearRect(-o/2/d,-a/2/d,o/d,a/d),e.fillStyle="white",e.fillRect(-h/2,-u/2,h,u),function e(t,i,n,r){const{baseProps:o,textures:a}=t;i.save(),P(i,o),a.forEach(t=>{if("type"in t){const e=M(i);return i.save(),P(i,t.props,o.opacity),function(e,t,i,n){switch(e.type){case"text":return t.text(e.props.font||n,e.props.text,e.props.align,e.props.color),0;case"circle":return t.circle(e.props.radius,e.props.color),0;case"rectangle":return t.rectangle(e.props.width,e.props.height,e.props.color),0;case"line":return t.line(e.props.path,e.props.thickness,e.props.color,e.props.fillColor,e.props.lineCap),0;case"image":const r=i[e.props.fileName];if(!r)throw Error(`Cannot find image file "${e.props.fileName}"`);return t.image(r,e.props.width,e.props.height),0;case"spriteSheet":t.spriteSheet(i[e.props.fileName],e.props.columns,e.props.rows,e.props.index,e.props.width,e.props.height)}}(t,e,n,r),void i.restore()}e(t,i,n,r)}),i.restore()}(t,e,s,c)}}}const x=Math.PI/180,P=(e,t,i=1)=>{const{x:n,y:r,rotation:o,scaleX:a,scaleY:s,anchorX:c,anchorY:d,opacity:h}=t;e.translate(n,-r),e.rotate(o*x),e.scale(a,s),e.translate(-c,d),e.globalAlpha=h*i,function(e,t){if(!t)return 0;switch(t.type){case"lineMask":{const[[i,n],...r]=t.path;return e.beginPath(),e.moveTo(i,-n),r.forEach(([t,i])=>{e.lineTo(t,-i)}),e.clip(),0}case"circleMask":return e.beginPath(),e.arc(t.x,-t.y,Math.round(t.radius),0,2*Math.PI),e.clip(),0;case"rectangleMask":e.beginPath(),e.rect(t.x-t.width/2,-t.y-t.height/2,t.width,t.height),e.clip()}}(e,t.mask)};const M=e=>({circle(t,i){e.beginPath(),e.arc(0,0,Math.round(t),0,2*Math.PI),e.fillStyle=i,e.fill(),e.closePath()},rectangle(t,i,n){e.fillStyle=n,e.fillRect(-t/2,-i/2,t,i),e.closePath()},line(t,i,n,r,o){if(t.length<2)return;const[[a,s],...c]=t;e.beginPath(),e.moveTo(a,-s),c.forEach(([t,i])=>{e.lineTo(t,-i)}),r&&(e.fillStyle=r,e.fill()),n&&(e.strokeStyle=n,e.lineWidth=i,e.lineCap=o,e.stroke())},text(t,i,n,r){const o=`${t.size}px ${t.name}`;e.font=o,e.textBaseline="middle",e.textAlign=n,e.fillStyle=r,e.fillText(i,0,0)},image(t,i,n){e.drawImage(t,-i/2,-n/2,i,n)},spriteSheet(t,i,n,r,o,a){const s=t.width/i,c=t.height/n,d=r%i,h=Math.floor(r/i)%n;e.drawImage(t,d*s,h*c,s,c,-o/2,-a/2,o,a)}});let S;function T(e,t,i,n){let r;if("portrait"in n){r=t>e?n.portrait:n.landscape}else r=n;const{width:o,height:a,maxWidthMargin:s=0,maxHeightMargin:c=0}=r;if("game-coords"===i)return{width:o,height:a,widthMargin:0,heightMargin:0,deviceWidth:o,deviceHeight:a};const d=o/a;if(d>e/t){const i=e,n=i/d,r=n/a*c,s=Math.min(t,n+2*r);return{width:o,height:a,widthMargin:0,heightMargin:(s-n)/2*(a/n),deviceWidth:i,deviceHeight:s}}{const i=t,n=i*d,r=n/o*s,c=Math.min(e,n+2*r);return{width:o,height:a,widthMargin:(c-n)/2*(o/n),heightMargin:0,deviceWidth:c,deviceHeight:i}}}function k(){const e={};return{start:(t,i)=>{const n=window.setTimeout(()=>{delete e[r],t()},i),r=String(n);return e[r]={timeoutId:n,callback:t,timeStartedMs:Date.now(),timeRemainingMs:i,isPaused:!1},r},pause:t=>{const i=e[t];if(!i||i.isPaused)return;const n=Date.now()-i.timeStartedMs;i.timeRemainingMs-=n,i.isPaused=!0,window.clearTimeout(i.timeoutId)},resume:t=>{const i=e[t];if(!i||!i.isPaused)return;i.timeStartedMs=Date.now(),i.isPaused=!1;const n=window.setTimeout(()=>{delete e[t],i.callback()},i.timeRemainingMs);i.timeoutId=n},cancel:t=>{const i=e[t];i&&(window.clearTimeout(i.timeoutId),delete e[t])}}}function L(e,t){return i=>{const{data:n,mutPlayState:r}=t[i];return{getPosition:()=>r?r.isPaused?r.alreadyPlayedTime:e.currentTime-r.startTime:0,play:(o,a=!1)=>{var s;const c=e.createBufferSource();c.buffer=n,c.connect(e.destination);const d=null!==(s=null!=o?o:null==r?void 0:r.alreadyPlayedTime)&&void 0!==s?s:0;c.start(void 0,d),c.loop=a,c.onended=()=>{var e;!1===(null===(e=t[i].mutPlayState)||void 0===e?void 0:e.isPaused)&&delete t[i].mutPlayState},r&&!r.isPaused||(t[i].mutPlayState={startTime:e.currentTime-d,sample:c,alreadyPlayedTime:d,isPaused:!1})},pause:()=>{r&&!r.isPaused&&(r.sample.stop(),t[i].mutPlayState={...r,alreadyPlayedTime:e.currentTime-r.startTime,isPaused:!0})}}}}function j(){if("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)return!0;return window.matchMedia("(touch-enabled),(-webkit-touch-enabled),(-moz-touch-enabled),(-o-touch-enabled),(-ms-touch-enabled)").matches}const E={name:"sans-serif",size:12};function O(e,{loadingTextures:t=[],assets:i={},dimensions:c="game-coords",nativeSpriteMap:d={},canvas:h,windowSize:u}){var l;const x=h||document.createElement("canvas");h||document.body.appendChild(x);const P=window.PointerEvent?"pointerdown":"touchstart",M=window.PointerEvent?"pointermove":"touchmove",k=window.PointerEvent?"pointerup":"touchend",L=window.PointerEvent?"pointercancel":"touchcancel",j=x.getContext("2d",{alpha:!1}),O=new(window.AudioContext||window.webkitAudioContext);let C=!0,W=!0,z=0,H=!1,X=0,Y=0;const _=()=>{document.hidden&&W&&(X=z,O.suspend()),document.hidden||W||(H=!0,setTimeout(()=>{O.suspend(),setTimeout(()=>{O.resume()},75)},75)),W=!document.hidden};let D,N,G,R,A,B;document.addEventListener("keydown",e=>{C&&p(e)},!1),document.addEventListener("keyup",e=>{C&&g(e)},!1),document.addEventListener("visibilitychange",_,!1),window.addEventListener("resize",U,!1),document.addEventListener("contextmenu",e=>{e.preventDefault()});const F={didResize:!1,scale:1,gameXToPlatformX:e=>e,gameYToPlatformY:e=>e};function U(t){if(D&&(j.restore(),document.removeEventListener(P,N),document.removeEventListener(M,G),document.removeEventListener(k,R),document.removeEventListener(L,A),!0===t))return;const i=function(e,t,i,n){const r=T(e,t,i,n);return S=r,r}((null==u?void 0:u.width)||window.innerWidth,(null==u?void 0:u.height)||window.innerHeight,c,e.props.size);x.width=i.deviceWidth,x.height=i.deviceHeight;const n=e.props.defaultFont||E,r=b(j,i,$,n);B=r.scale,K.ref=r.render,F.gameXToPlatformX=(({canvasOffsetLeft:e,widthMargin:t,scale:i,width:n})=>r=>e+i*(r+n/2+t))({canvasOffsetLeft:x.offsetLeft,width:i.width,widthMargin:i.widthMargin,scale:B}),F.gameYToPlatformY=(({canvasOffsetTop:e,heightMargin:t,scale:i,height:n})=>r=>e-i*(r-n/2-t))({canvasOffsetTop:x.offsetTop,height:i.height,heightMargin:i.heightMargin,scale:B}),F.didResize=!0,F.scale=B;const o=(({canvasOffsetLeft:e,widthMargin:t,scale:i,width:n})=>r=>(r.clientX-e)/i-t-n/2)({canvasOffsetLeft:x.offsetLeft,width:i.width,widthMargin:i.widthMargin,scale:B}),a=(({canvasOffsetTop:e,heightMargin:t,scale:i,height:n})=>r=>-(r.clientY-e)/i+t+n/2)({canvasOffsetTop:x.offsetTop,height:i.height,heightMargin:i.heightMargin,scale:B}),s=(e,t)=>e>i.width/2+i.widthMargin||e<-i.width/2-i.widthMargin||t>i.height/2+i.heightMargin||t<-i.height/2-i.heightMargin;N=e=>{if("changedTouches"in e){C=!1;for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],n=o({clientX:i.screenX}),r=a({clientY:i.screenY});s(n,r)||(C=!0,f(n,r,i.identifier))}return}const t=o(e),i=a(e);s(t,i)?C=!1:(C=!0,f(t,i,e.pointerId))},G=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],n=o({clientX:i.screenX}),r=a({clientY:i.screenY});s(n,r)||m(n,r)}return}const t=o(e),i=a(e);s(t,i)||m(t,i)},R=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],n=o({clientX:i.screenX}),r=a({clientY:i.screenY});s(n,r)?w(i.identifier):v(n,r,i.identifier)}return}const t=o(e),i=a(e);s(t,i)?w(e.pointerId):v(t,i,e.pointerId)},A=e=>{if("changedTouches"in e)for(let t=0;t<e.changedTouches.length;t++)w(e.changedTouches[t].identifier);else w(e.pointerId)},document.addEventListener(P,N,!1),document.addEventListener(M,G,!1),document.addEventListener(k,R,!1),document.addEventListener(L,A,!1),D=i}const J={},$={},q={getGetDevice:I(O,J,T((null==u?void 0:u.width)||window.innerWidth,(null==u?void 0:u.height)||window.innerHeight,c,e.props.size))},K={ref:null};U();let Q=!1;return null===(l=K.ref)||void 0===l||l.call(K,{id:"Loading",baseProps:Object(n.a)({}),textures:t}),{cleanup:function(){x.width=x.width,h||document.body.removeChild(x),Q=!0,document.removeEventListener("keydown",p,!1),document.removeEventListener("keyup",g,!1),document.removeEventListener("visibilitychange",_,!1),window.removeEventListener("resize",U,!1),U(!0)},loadPromise:(async()=>{const e=[];(i.audioFileNames||[]).forEach(t=>{e.push(async function(e,t){const i=await fetch(t),n=await i.arrayBuffer();return await new Promise((t,i)=>{e.decodeAudioData(n,t,i)})}(O,t).then(e=>{J[t]={data:e}}))}),(i.imageFileNames||[]).forEach(t=>{$[t]=new Image,e.push(new Promise((e,i)=>{$[t].addEventListener("load",e),$[t].addEventListener("error",i),$[t].src=t}))}),await Promise.all(e)})().then(()=>{const t=()=>{document.removeEventListener("keydown",t,!1),document.removeEventListener(P,t,!1),"suspended"===O.state&&O.resume()};document.addEventListener("keydown",t,!1),document.addEventListener(P,t,!1);const{initTextures:i,getNextFrameTextures:n}=function(e,t,i,n){const c=({x:e,y:t})=>({x:e,y:t}),d=e.getGetDevice(),h=d(c),u=a(i,d(c),0),l=n||i.props.size,p=s(h.size,l);let g=0,f=0,m=r(u,i.props,d,c,!0,p,0,1,i.props.id,t);return{initTextures:m,getNextFrameTextures(n,a){const d=n-g;for(g=n,f+=d;f>=o;){f-=o;const n=f/o,d=e.getGetDevice(),h=s(d(c).size,l);m=r(u,i.props,d,c,!1,h,n,1,i.props.id,t),a()}return m}}}(q,{nativeSpriteMap:d,nativeSpriteUtils:F},e);let c=null;!function e(t){var i;null===(i=K.ref)||void 0===i||i.call(K,t),window.requestAnimationFrame(t=>{Q||(null===c&&(c=t-1/60),H&&(H=!1,Y+=t-X),z=t,e(n(t-c-Y,y)))})}(i)}),audioElements:J,audioContext:O}}function I(e,t,i){const n={isTouchScreen:j(),log:console.log,random:Math.random,timer:k(),audio:L(e,t),network:{get:(e,t)=>{fetch(e).then(e=>e.json()).then(t)},post:(e,t,i)=>{fetch(e,{method:"POST",body:JSON.stringify(t)}).then(e=>e.json()).then(i)},put:(e,t,i)=>{fetch(e,{method:"PUT",body:JSON.stringify(t)}).then(e=>e.json()).then(i)},delete:(e,t)=>{fetch(e,{method:"DELETE"}).then(e=>e.json()).then(t)}},storage:{getStore:()=>{var e;const t={};for(let i=0;i<localStorage.length;i++){const n=localStorage.key(i);n&&(t[n]=null!==(e=localStorage.getItem(n))&&void 0!==e?e:void 0)}return t},setStore:e=>{Object.entries(e).forEach(([e,t])=>{void 0===t?localStorage.removeItem(e):localStorage.setItem(e,t)})}},alert:{ok:(e,t)=>{alert(e),null==t||t()},okCancel:(e,t)=>{t(confirm(e))}},clipboard:{copy:(e,t)=>{navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{t()}).catch(e=>{t(e)}):t(new Error(window.isSecureContext?"Couldn't access clipboard":"Clipboard only available on HTTPS or localhost"))}}};return()=>{const e={...n,size:S||i,now:()=>new Date};return t=>({...e,inputs:l(t)})}}}]);